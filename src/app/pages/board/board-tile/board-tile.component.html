<div
  boardTileResize
  [rect]="{
    x: tile.x,
    y: tile.y,
    width: tile.width,
    height: tile.height,
  }"
  [zoom]="zoom"
  (rectChange)="onTileWorldRectChange($event)"
  class="board-item"
  [style.width.px]="tile.width"
  [style.height.px]="tile.height"
  [style.left.px]="tile.x"
  [style.top.px]="tile.y"
>
  <div class="tile-surface">
    <div
      class="tile-header"
      boardTileMove=""
      [pos]="{ x: tile.x, y: tile.y }"
      [zoom]="zoom"
      (posChange)="onTileWorldPosChange($event)"
      (moveStart)="onMoveStart()"
      (moveEnd)="onMoveEnd()"
    >
      <div #titleElement class="title-editor"></div>
    </div>
    <div class="tile-body">
      <div #contentElement class="content-editor"></div>
    </div>
  </div>

  <ng-template #navbarContentTemplate let-tile="tile">
    <div class="bar">
      <div #normalControls class="navbar-tile-controls">
        <div class="navbar-title" [innerHTML]="tile.label"></div>
        <div class="navbar-spacer"></div>
        <!-- Font Selection -->
        <app-query-select
          [options]="tiptap.fonts"
          labelKey="name"
          valueKey="name"
          placeholder="Font"
          title="Font family"
          [allowCustom]="false"
          (commit)="tiptap.applyFont($event, contentEditor)"
        ></app-query-select>

        <app-query-select
          [options]="tiptap.fontSizes"
          labelKey="name"
          valueKey="value"
          placeholder="Size"
          title="Font size"
          (commit)="tiptap.applyFontSize($event, contentEditor)"
        ></app-query-select>
        <div class="navbar-spacer"></div>
        <!-- Text Formatting -->
        <div
          class="color-picker-container"
          (mouseenter)="isColorPaletteVisible = true"
          (mouseleave)="isColorPaletteVisible = false"
        >
          <button title="Text color">
            <app-svg-icon icon="editor-textcolor"></app-svg-icon>
          </button>
          <div class="color-palette" [class.open]="isColorPaletteVisible">
            <div class="temp"></div>
            <button
              *ngFor="let color of tiptap.colors"
              [style.background-color]="color"
              (click)="tiptap.setTextColor(color, contentEditor)"
              [title]="color"
              class="color-option"
            ></button>
          </div>
        </div>
        <button
          (click)="tiptap.toggleBold(contentEditor)"
          aria-label="Bold"
          title="Bold"
        >
          <app-svg-icon icon="editor-bold"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleItalic(contentEditor)"
          aria-label="Italic"
          title="Italic"
        >
          <app-svg-icon icon="editor-italic"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleUnderline(contentEditor)"
          aria-label="Underline"
          title="Underline"
        >
          <app-svg-icon icon="editor-underline"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleStrikethrough(contentEditor)"
          aria-label="Strikethrough"
          title="Strikethrough"
        >
          <app-svg-icon icon="editor-strikethrough"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <!-- Text Styles & Special Elements -->
        <button
          (click)="tiptap.toggleQuote(contentEditor)"
          aria-label="Quote"
          title="Quote"
        >
          <app-svg-icon icon="editor-quote"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleCodeBlock(contentEditor)"
          aria-label="Code block"
          title="Code block"
        >
          <app-svg-icon icon="editor-code-duplicate"></app-svg-icon>
        </button>

        <div class="navbar-spacer"></div>
        <!-- Lists -->
        <button
          (click)="tiptap.toggleBulletList(contentEditor)"
          aria-label="Bullet list"
          title="Bullet list"
        >
          <app-svg-icon icon="editor-ul"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleOrderedList(contentEditor)"
          aria-label="Ordered list"
          title="Ordered list"
        >
          <app-svg-icon icon="editor-ol"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <!-- Alignment -->
        <button
          (click)="tiptap.setAlignment('left', contentEditor)"
          aria-label="Align left"
          title="Align left"
        >
          <app-svg-icon icon="editor-alignleft"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.setAlignment('center', contentEditor)"
          aria-label="Align center"
          title="Align center"
        >
          <app-svg-icon icon="editor-aligncenter"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.setAlignment('right', contentEditor)"
          aria-label="Align right"
          title="Align right"
        >
          <app-svg-icon icon="editor-alignright"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.setAlignment('justify', contentEditor)"
          aria-label="Justify"
          title="Justify"
        >
          <app-svg-icon icon="editor-justify"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <button
          (click)="tiptap.insertTable(contentEditor)"
          aria-label="Insert table"
          title="Insert table"
        >
          <app-svg-icon icon="table"></app-svg-icon>
        </button>
      </div>

      <div #tableControls class="table-controls" *ngIf="tiptap.isTableActive">
        <button
          (click)="tiptap.addColumnBefore(contentEditor)"
          aria-label="Add column before"
          title="Add column before"
        >
          <app-svg-icon icon="table-add-column-before"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.addColumnAfter(contentEditor)"
          aria-label="Add column after"
          title="Add column after"
        >
          <app-svg-icon icon="table-add-column-after"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.addRowBefore(contentEditor)"
          aria-label="Add row before"
          title="Add row before"
        >
          <app-svg-icon icon="table-add-row-before"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.addRowAfter(contentEditor)"
          aria-label="Add row after"
          title="Add row after"
        >
          <app-svg-icon icon="table-add-row-after"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.deleteColumn(contentEditor)"
          aria-label="Delete column"
          title="Delete column"
        >
          <app-svg-icon icon="table-delete-column"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.deleteRow(contentEditor)"
          aria-label="Delete row"
          title="Delete row"
        >
          <app-svg-icon icon="table-delete-row"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.mergeCells(contentEditor)"
          aria-label="Merge cells"
          title="Merge cells"
        >
          <app-svg-icon icon="table-merge-cells"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.splitCell(contentEditor)"
          aria-label="Split cell"
          title="Split cell"
        >
          <app-svg-icon icon="table-split-cell"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleHeaderColumn(contentEditor)"
          aria-label="Toggle header column"
          title="Toggle header column"
        >
          <app-svg-icon icon="table-freeze-column"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleHeaderRow(contentEditor)"
          aria-label="Toggle header row"
          title="Toggle header row"
        >
          <app-svg-icon icon="table-freeze-row"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleHeaderCell(contentEditor)"
          aria-label="Toggle header cell"
          title="Toggle header cell"
        >
          <app-svg-icon icon="table-freeze-cell"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.alignTableLeft(contentEditor)"
          aria-label="Align table left"
          title="Align table left"
        >
          <app-svg-icon icon="editor-alignleft"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.alignTableCenter(contentEditor)"
          aria-label="Align table center"
          title="Align table center"
        >
          <app-svg-icon icon="editor-aligncenter"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.alignTableRight(contentEditor)"
          aria-label="Align table right"
          title="Align table right"
        >
          <app-svg-icon icon="editor-alignright"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.deleteTable(contentEditor)"
          aria-label="Delete table"
          title="Delete table"
        >
          <app-svg-icon icon="table-delete"></app-svg-icon>
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #navbarTitleTemplate let-tile="tile">
    <div class="bar">
      <div class="navbar-tile-controls">
        <div class="navbar-label">
          <div [innerHTML]="tile.label"></div>
        </div>
        <div class="navbar-spacer"></div>
        <!-- Font Selection -->
        <app-query-select
          [options]="tiptap.fonts"
          labelKey="name"
          valueKey="name"
          placeholder="Font"
          title="Font family"
          [allowCustom]="false"
          (commit)="tiptap.applyFont($event, titleEditor)"
        ></app-query-select>

        <div class="navbar-spacer"></div>

        <!-- Color -->
        <div
          class="color-picker-container"
          (mouseenter)="isColorPaletteVisible = true"
          (mouseleave)="isColorPaletteVisible = false"
        >
          <button class="color-picker-btn" title="Text color">
            <app-svg-icon icon="editor-textcolor"></app-svg-icon>
          </button>
          <div class="color-palette" [class.open]="isColorPaletteVisible">
            <div class="temp"></div>
            <button
              *ngFor="let color of tiptap.colors"
              [style.background-color]="color"
              (click)="tiptap.setTextColor(color, titleEditor)"
              [title]="color"
              class="color-option"
            ></button>
          </div>
        </div>

        <button
          (click)="tiptap.toggleBold(titleEditor)"
          aria-label="Bold"
          title="Bold"
        >
          <app-svg-icon icon="editor-bold"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleItalic(titleEditor)"
          aria-label="Italic"
          title="Italic"
        >
          <app-svg-icon icon="editor-italic"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleUnderline(titleEditor)"
          aria-label="Underline"
          title="Underline"
        >
          <app-svg-icon icon="editor-underline"></app-svg-icon>
        </button>
        <button
          (click)="tiptap.toggleStrikethrough(titleEditor)"
          aria-label="Strikethrough"
          title="Strikethrough"
        >
          <app-svg-icon icon="editor-strikethrough"></app-svg-icon>
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #defaultNavbarTemplate> </ng-template>
</div>
