<div
  boardTileResize
  [rect]="{
    x: tile.x,
    y: tile.y,
    width: tile.width,
    height: tile.height,
  }"
  [zoom]="zoom"
  (rectChange)="onTileWorldRectChange($event)"
  class="board-item"
  [style.width.px]="tile.width"
  [style.height.px]="tile.height"
  [style.left.px]="tile.x"
  [style.top.px]="tile.y"
>
  <div class="editor-wrap">
    <div #titleElement class="title-editor"></div>
    <div #contentElement class="content-editor"></div>
  </div>

  <ng-template
    #navbarContentTemplate
    let-tile="tile"
    let-toggleBold="toggleBold"
    let-toggleItalic="toggleItalic"
    let-toggleUnderline="toggleUnderline"
    let-toggleStrikethrough="toggleStrikethrough"
    let-toggleQuote="toggleQuote"
    let-toggleBulletList="toggleBulletList"
    let-toggleOrderedList="toggleOrderedList"
    let-insertTable="insertTable"
    let-setLink="setLink"
    let-setAlignment="setAlignment"
    let-toggleCodeBlock="toggleCodeBlock"
  >
    <div class="bar">
      <div #normalControls class="navbar-tile-controls">
        <div class="navbar-title" [innerHTML]="tile.label"></div>
        <div class="navbar-spacer"></div>
        <!-- Font Selection -->
        <app-query-select
          [options]="fonts"
          labelKey="name"
          valueKey="name"
          placeholder="Font"
          title="Font family"
          [allowCustom]="false"
          (commit)="applyFont($event, contentEditor)"
        ></app-query-select>

        <app-query-select
          [options]="fontSizes"
          labelKey="name"
          valueKey="value"
          placeholder="Size"
          title="Font size"
          (commit)="applyFontSize($event, contentEditor)"
        ></app-query-select>
        <div class="navbar-spacer"></div>
        <!-- Text Formatting -->
        <div
          class="color-picker-container"
          (mouseenter)="isColorPaletteVisible = true"
          (mouseleave)="isColorPaletteVisible = false"
        >
          <button title="Text color">
            <app-svg-icon icon="editor-textcolor"></app-svg-icon>
          </button>
          <div class="color-palette" [class.open]="isColorPaletteVisible">
            <div class="temp"></div>
            <button
              *ngFor="let color of colors"
              [style.background-color]="color"
              (click)="setTextColor(color, contentEditor)"
              [title]="color"
              class="color-option"
            ></button>
          </div>
        </div>
        <button
          (click)="toggleBold(contentEditor)"
          aria-label="Bold"
          title="Bold"
        >
          <app-svg-icon icon="editor-bold"></app-svg-icon>
        </button>
        <button
          (click)="toggleItalic(contentEditor)"
          aria-label="Italic"
          title="Italic"
        >
          <app-svg-icon icon="editor-italic"></app-svg-icon>
        </button>
        <button
          (click)="toggleUnderline(contentEditor)"
          aria-label="Underline"
          title="Underline"
        >
          <app-svg-icon icon="editor-underline"></app-svg-icon>
        </button>
        <button
          (click)="toggleStrikethrough(contentEditor)"
          aria-label="Strikethrough"
          title="Strikethrough"
        >
          <app-svg-icon icon="editor-strikethrough"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <!-- Text Styles & Special Elements -->
        <button
          (click)="toggleQuote(contentEditor)"
          aria-label="Quote"
          title="Quote"
        >
          <app-svg-icon icon="editor-quote"></app-svg-icon>
        </button>
        <button
          (click)="toggleCodeBlock(contentEditor)"
          aria-label="Code block"
          title="Code block"
        >
          <app-svg-icon icon="editor-code-duplicate"></app-svg-icon>
        </button>

        <div class="navbar-spacer"></div>
        <!-- Lists -->
        <button
          (click)="toggleBulletList(contentEditor)"
          aria-label="Bullet list"
          title="Bullet list"
        >
          <app-svg-icon icon="editor-ul"></app-svg-icon>
        </button>
        <button
          (click)="toggleOrderedList(contentEditor)"
          aria-label="Ordered list"
          title="Ordered list"
        >
          <app-svg-icon icon="editor-ol"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <!-- Alignment -->
        <button
          (click)="setAlignment('left', contentEditor)"
          aria-label="Align left"
          title="Align left"
        >
          <app-svg-icon icon="editor-alignleft"></app-svg-icon>
        </button>
        <button
          (click)="setAlignment('center', contentEditor)"
          aria-label="Align center"
          title="Align center"
        >
          <app-svg-icon icon="editor-aligncenter"></app-svg-icon>
        </button>
        <button
          (click)="setAlignment('right', contentEditor)"
          aria-label="Align right"
          title="Align right"
        >
          <app-svg-icon icon="editor-alignright"></app-svg-icon>
        </button>
        <button
          (click)="setAlignment('justify', contentEditor)"
          aria-label="Justify"
          title="Justify"
        >
          <app-svg-icon icon="editor-justify"></app-svg-icon>
        </button>
        <div class="navbar-spacer"></div>
        <button
          (click)="insertTable(contentEditor)"
          aria-label="Insert table"
          title="Insert table"
        >
          <app-svg-icon icon="table"></app-svg-icon>
        </button>
      </div>

      <div #tableControls class="table-controls" *ngIf="isTableActive">
        <button
          (click)="addColumnBefore(contentEditor)"
          aria-label="Add column before"
          title="Add column before"
        >
          <app-svg-icon icon="table-add-column-before"></app-svg-icon>
        </button>
        <button
          (click)="addColumnAfter(contentEditor)"
          aria-label="Add column after"
          title="Add column after"
        >
          <app-svg-icon icon="table-add-column-after"></app-svg-icon>
        </button>
        <button
          (click)="addRowBefore(contentEditor)"
          aria-label="Add row before"
          title="Add row before"
        >
          <app-svg-icon icon="table-add-row-before"></app-svg-icon>
        </button>
        <button
          (click)="addRowAfter(contentEditor)"
          aria-label="Add row after"
          title="Add row after"
        >
          <app-svg-icon icon="table-add-row-after"></app-svg-icon>
        </button>
        <button
          (click)="deleteColumn(contentEditor)"
          aria-label="Delete column"
          title="Delete column"
        >
          <app-svg-icon icon="table-delete-column"></app-svg-icon>
        </button>
        <button
          (click)="deleteRow(contentEditor)"
          aria-label="Delete row"
          title="Delete row"
        >
          <app-svg-icon icon="table-delete-row"></app-svg-icon>
        </button>
        <button
          (click)="mergeCells(contentEditor)"
          aria-label="Merge cells"
          title="Merge cells"
        >
          <app-svg-icon icon="table-merge-cells"></app-svg-icon>
        </button>
        <button
          (click)="splitCell(contentEditor)"
          aria-label="Split cell"
          title="Split cell"
        >
          <app-svg-icon icon="table-split-cell"></app-svg-icon>
        </button>
        <button
          (click)="toggleHeaderColumn(contentEditor)"
          aria-label="Toggle header column"
          title="Toggle header column"
        >
          <app-svg-icon icon="table-freeze-column"></app-svg-icon>
        </button>
        <button
          (click)="toggleHeaderRow(contentEditor)"
          aria-label="Toggle header row"
          title="Toggle header row"
        >
          <app-svg-icon icon="table-freeze-row"></app-svg-icon>
        </button>
        <button
          (click)="toggleHeaderCell(contentEditor)"
          aria-label="Toggle header cell"
          title="Toggle header cell"
        >
          <app-svg-icon icon="table-freeze-cell"></app-svg-icon>
        </button>
        <button
          (click)="alignTableLeft(contentEditor)"
          aria-label="Align table left"
          title="Align table left"
        >
          <app-svg-icon icon="editor-alignleft"></app-svg-icon>
        </button>
        <button
          (click)="alignTableCenter(contentEditor)"
          aria-label="Align table center"
          title="Align table center"
        >
          <app-svg-icon icon="editor-aligncenter"></app-svg-icon>
        </button>
        <button
          (click)="alignTableRight(contentEditor)"
          aria-label="Align table right"
          title="Align table right"
        >
          <app-svg-icon icon="editor-alignright"></app-svg-icon>
        </button>
        <button
          (click)="deleteTable(contentEditor)"
          aria-label="Delete table"
          title="Delete table"
        >
          <app-svg-icon icon="table-delete"></app-svg-icon>
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template
    #navbarTitleTemplate
    let-tile="tile"
    let-toggleBold="toggleBold"
    let-toggleItalic="toggleItalic"
    let-toggleUnderline="toggleUnderline"
    let-toggleStrikethrough="toggleStrikethrough"
  >
    <div class="bar">
      <div class="navbar-tile-controls">
        <div class="navbar-label">
          <div [innerHTML]="tile.label"></div>
        </div>
        <div class="navbar-spacer"></div>
        <!-- Font Selection -->
        <app-query-select
          [options]="fonts"
          labelKey="name"
          valueKey="name"
          placeholder="Font"
          title="Font family"
          [allowCustom]="false"
          (commit)="applyFont($event, titleEditor)"
        ></app-query-select>

        <div class="navbar-spacer"></div>

        <!-- Color -->
        <div
          class="color-picker-container"
          (mouseenter)="isColorPaletteVisible = true"
          (mouseleave)="isColorPaletteVisible = false"
        >
          <button class="color-picker-btn" title="Text color">
            <app-svg-icon icon="editor-textcolor"></app-svg-icon>
          </button>
          <div class="color-palette" [class.open]="isColorPaletteVisible">
            <div class="temp"></div>
            <button
              *ngFor="let color of colors"
              [style.background-color]="color"
              (click)="setTextColor(color, titleEditor)"
              [title]="color"
              class="color-option"
            ></button>
          </div>
        </div>

        <button
          (click)="toggleBold(titleEditor)"
          aria-label="Bold"
          title="Bold"
        >
          <app-svg-icon icon="editor-bold"></app-svg-icon>
        </button>
        <button
          (click)="toggleItalic(titleEditor)"
          aria-label="Italic"
          title="Italic"
        >
          <app-svg-icon icon="editor-italic"></app-svg-icon>
        </button>
        <button
          (click)="toggleUnderline(titleEditor)"
          aria-label="Underline"
          title="Underline"
        >
          <app-svg-icon icon="editor-underline"></app-svg-icon>
        </button>
        <button
          (click)="toggleStrikethrough(titleEditor)"
          aria-label="Strikethrough"
          title="Strikethrough"
        >
          <app-svg-icon icon="editor-strikethrough"></app-svg-icon>
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #defaultNavbarTemplate> </ng-template>
</div>
